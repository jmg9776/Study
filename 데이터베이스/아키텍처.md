2023-11-01
성능 향상을 위한 물리 데이터 모델의 방법론에 대해서는 다양한 접근 방식이 있을 수 있어요. 하지만 중요한 것은 데이터 아키텍처 전략을 구축할 때, 단순히 현재의 상황만을 고려하는 것이 아니라 미래의 변화와 확장성을 함께 고려하는 것이 중요해요. 이렇게 전반적인 데이터 관리 전략을 잘 구축하면, 기업의 업무 효율성과 데이터 활용도를 크게 향상시킬 수 있을 거에요.

데이터베이스 아키텍팅이란 무엇일까요? 일상에서 보면, 도서관의 책들이 잘 정리되어 있지 않으면, 원하는 책을 찾기 힘들겠죠. 마찬가지로, 정보를 저장하는 데이터베이스도 잘 설계되어 있지 않으면 정보 검색이나 저장이 어려워져요. 데이터베이스 아키텍팅은 바로 그런 데이터베이스를 효율적으로 설계하는 작업을 말해요.

그럼 왜 데이터베이스 아키텍팅이 중요할까요? 생각해보면, 우리가 웹사이트나 앱을 사용할 때 빠르게 정보를 얻고 싶어하잖아요? 데이터베이스가 잘 설계되어 있지 않으면, 사용자는 원하는 정보를 늦게 받게 되고, 이로 인해 서비스 사용에 불편을 느낄 수 있어요. 따라서 데이터베이스 아키텍팅은 사용자 경험을 직접적으로 영향을 미칠 수 있는 중요한 작업이에요.

데이터베이스 아키텍팅을 할 때는 어떤 점을 고려해야 할까요? 첫째로, 데이터의 종류와 양을 파악해야 해요. 둘째로, 얼마나 빠르게 데이터에 접근할 필요가 있는지를 생각해봐야 하구요. 셋째로, 데이터의 보안도 중요하게 고려되어야 해요. 이렇게 여러 가지 요소를 고려하여 데이터베이스를 설계하는 것이 바로 데이터베이스 아키텍팅이에요.
### 데이터베이스 아키텍팅을 할 때 고려해야 할 여러 가지

데이터의 종류와 양: 무슨 데이터를 저장할 것인지, 그 데이터의 양은 얼마나 될지를 파악해야 해요. 예를 들면, 텍스트 데이터만 저장할 것인지, 이미지나 동영상과 같은 미디어 데이터도 저장할 것인지 고려해야 돼요.

데이터 접근 속도: 사용자가 서비스를 이용할 때, 데이터를 얼마나 빠르게 불러와야 하는지를 생각해봐야 해요. 실시간 서비스인 경우, 데이터 접근 속도가 중요하겠죠.

데이터의 보안: 중요한 정보나 개인 정보를 저장하는 경우, 데이터베이스의 보안을 철저히 해야 해요. 해킹이나 데이터 유출을 방지하기 위한 여러 방법들을 고려해야 하구요.

데이터의 확장성: 서비스가 성장하면서 데이터의 양이 증가할 것을 예상해야 해요. 이런 경우를 대비하여 데이터베이스의 확장성을 고려하는 것이 중요하죠.

백업과 복구: 데이터가 손실되는 경우를 대비하여, 데이터의 백업과 복구 방안을 마련해야 해요.

데이터베이스의 유지 보수: 시간이 지나면서 데이터베이스의 성능이 저하될 수 있어요. 이런 경우를 대비하여 정기적인 유지 보수 계획을 세우는 것이 좋아요.

이렇게 데이터베이스 아키텍팅을 할 때는 다양한 요소들을 고려해야 해요. 각 요소들을 잘 고려하여 데이터베이스를 설계하는 것이 중요하죠.

### 1. 파티셔닝
파티션의 종류에는 여러 가지가 있어요. 첫 번째로 Range 파티셔닝은 값의 범위를 기반으로 데이터를 분할해요. 예를 들어, 날짜 범위에 따라 데이터를 분할하고자 할 때 사용해요.

두 번째로 Interval 파티셔닝은 Range 파티셔닝을 자동화한 형태로 생각할 수 있어요. 주어진 간격에 따라 자동으로 파티션을 생성해요. 예를 들면, 매월 데이터를 자동으로 분할하고자 할 때 사용해요.

세 번째로 List 파티셔닝은 명시적으로 지정한 값의 목록을 기반으로 데이터를 분할해요. 특정 값들을 기반으로 파티션을 생성하고자 할 때 이용해요.

마지막으로 Hash 파티셔닝은 해시 함수의 결과값을 기반으로 데이터를 분할해요. 이 방법은 데이터 분배가 균등하게 이루어져야 할 때 유용하게 사용해요.

각 파티션의 종류는 특정 조건과 패턴에 따라 선택하면 돼요. 적절한 파티션 방식을 선택하면 데이터 관리와 조회 성능이 향상될 수 있어요.

데이터베이스에서 "파티션"이라는 것은 큰 테이블이나 인덱스를 손쉽게 관리할 수 있도록 작은 단위로 나누어 저장하는 기능을 말해요. 예를 들어, 10년간의 거래 내역을 하나의 엑셀 파일로 저장하면 파일이 크기 때문에 데이터를 찾는 것이 어려워지고 처리 속도도 느려져요. 이를 월 단위로 나누어 저장하면 각 파일이 경량화되어 데이터 검색과 입력이 빨라져요. 이와 같이, 데이터베이스에서도 특정 기준에 따라 데이터를 분리하여 저장하고 관리하는 것이 파티션의 역할이에요. 특정 기준으로 데이터가 분리되면, 그 기준에 따라 필요한 데이터만 빠르게 액세스할 수 있어요.

예를 들어, 'YYYYMM' 값이 '201903'인 데이터를 조회할 때 일반 테이블에서는 전체 테이블을 탐색해야하지만, 'YYYYMM' 값을 기준으로 파티션된 테이블에서는 해당 값에 맞는 파티션만 탐색하면 돼요. 이로 인해 데이터베이스의 성능이 향상될 수 있어요.

하지만 모든 테이블을 파티션 테이블로 만드는 것은 바람직하지 않아요. 작은 크기의 테이블을 파티션하면 관리 포인트가 늘어나고, 데이터 저장이 분산되어 전체 블럭 수가 증가할 수 있어요. 대용량의 데이터를 가진 테이블과 특정 조건으로 자주 조회되는 테이블만 파티션 대상으로 삼아야 해요.

데이터 아키텍처는 단순히 데이터를 수집하고 저장하는 것을 넘어서, 어떻게 데이터를 효율적으로 관리하고 활용할 것인지에 대한 전략과 방향성을 제시해야 해요. 이를 위해 데이터 요구분석, 데이터베이스 선택, 서버 구성, 데이터 표준화, 데이터 모델링 등 다양한 항목을 고려해야 하며, 각 항목마다 세부적인 요소들을 신중하게 선택하고 결정해야 해요.

### 2. View와 UDF 
View와 UDF 사용에 대한 고려 View는 별도의 저장 공간 없이 SQL문만 저장돼 있어요. 뷰를 사용할 때마다 저장된 SQL문을 실행해서 결과를 보여줘요.

View의 장점:

정보 보안성을 강화할 수 있어요. 예로, 고객 테이블의 주민등록번호 같은 개인 정보를 일반 사용자에게 숨길 수 있어요. 이럴 때 주민등록번호를 제외한 뷰를 만들어, 그 뷰로 정보를 조회할 수 있게 해요. 쿼리 작성이 간편해져요. 복잡한 쿼리를 뷰로 만들면, 간결하고 읽기 좋게 됩니다. View의 단점:

관리 포인트가 많아져요. 많은 뷰를 만들면 관리해야 할 객체가 늘어나요. 특히, 뷰가 참조하는 테이블이 바뀌면 뷰에도 영향이 있을 수 있어요. 성능 부하가 생길 수 있어요. 복잡한 뷰 쿼리는 최적화하기 어려울 수 있어요. 그래서 보안 목적 외에는 뷰 생성을 줄이는 것이 좋다는 원칙을 가지고 있어요.

UDF도 비슷해요. UDF는 복잡한 계산을 절차적으로 해결할 때 유용하죠. 하지만 UDF가 많이 호출되면 성능 부하가 생길 수 있어요.

예로, 선택된 UDF의 호출 횟수는 데이터 결과와 같아요. 만약 10만건의 데이터가 있다면, UDF도 10만번 실행돼요. 이렇게 되면 과도한 블럭 액세스가 발생할 수 있습니다.

결론적으로, 뷰와 UDF 사용은 장단점을 고려해서 적절히 활용해야 해요.

### 3. 데이터 모델의 변경
데이터 모델 변경의 어려움 데이터 모델 설계는 건물 짓기와 비슷해요. 한번 완성된 건물의 1층 높이를 바꾸는 건 상상도 할 수 없죠. 마찬가지로 서비스 중인 시스템에서 데이터 모델 변경도 쉽지 않아요. 하지만 때로는 성능 개선을 위해 필요해요.

예를 들면, 도서관에서 책을 찾을 때마다 모든 책장을 뒤져야 한다면 시간이 오래 걸리겠죠? 그래서 베스트셀러나 인기 도서 코너처럼 특정 책들을 따로 모아둔다면 빠르게 찾을 수 있어요. 이렇게 데이터베이스에서도 집계 테이블을 만들어서 빠르게 데이터를 찾는 것을 고려할 수 있어요.

그런데 큰 데이터 테이블, 예컨대 연도별 도서 대출 내역 같은 걸 바꾸려면 많은 주의가 필요해요. 바뀐 테이블로 인해 이전에 잘 동작하던 검색 쿼리가 문제를 일으킬 수 있거든요. 그래서 변경 전에는 임시 테이블에 데이터를 넣어 테스트를 꼭 해봐야 해요. 그리고 문제가 없으면 실제 데이터를 옮기는 작업도 필요하고, 다른 관련 작업도 잊지 말아야 해요